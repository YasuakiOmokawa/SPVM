#!perl

use strict;
use warnings;

use SPVM();
use SPVM::Builder::Util;

my $run_spvm;
my $package_name;
BEGIN {
  SPVM::Builder::Util::getopt(
    'h|help'          => \my $help,
    'v|version'       => \my $show_version,
    'I|include-dir=s' => \my @include_dirs,
  );

  if ($show_version) {
    print "SPVM version $SPVM::VERSION\n";
    exit;
  }
  else {
    if ($help || !($package_name = shift)) {
      print SPVM::Builder::Util::extract_usage ;
      exit;
    }
    unshift @INC, @include_dirs;
    $run_spvm = 1;
  }
}

use SPVM $package_name;

$package_name->main(@ARGV);

=encoding utf8

=head1 NAME

spvm - SPVM compiler to create exe file

=head1 SYNOPSIS

  Usage: spvm [OPTIONS] [PACKAGE] [ARGS...]

    spvm -I. MyApp
    spvm -Ilib My::App 1 2

  Options:
    -h, --help                     Show this message
    -v, --version                  Version
    -I, --include-dir <directory>  Add module path

=head1 DESCRIPTION

spvm - execute SPVM program
